<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{main}">
<!--begin::Main-->
<meta name="_csrf" th:content="${_csrf.token}"/>
<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
<div layout:fragment="content">
    <script src="/assets/plugins/global/plugins.bundle.js"></script>
    <!-- ì›”ë³„ ì„ íƒ í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€ -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/index.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/style.css">
    <!-- html2canvas for image generation -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <div class="d-flex flex-column flex-column-fluid">
        <!--begin::Toolbar-->
        <div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
            <!--begin::Toolbar container-->
            <div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
                <!--begin::Page title-->
                <div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
                    <!--begin::Title-->
                    <h1 class="page-heading d-flex text-gray-900 fw-bold fs-3 flex-column justify-content-center my-0">ì›”ê°„ ìš´ì˜í˜„í™©</h1>
                    <!--end::Title-->
                    <!--begin::Breadcrumb-->
                    <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
                        <!--begin::Item-->
                        <li class="breadcrumb-item text-muted">
                            <a href="/main" class="text-muted text-hover-primary">Home</a>
                        </li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item">
                            <span class="bullet bg-gray-500 w-5px h-2px"></span>
                        </li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item text-muted">í†µê³„</li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item">
                            <span class="bullet bg-gray-500 w-5px h-2px"></span>
                        </li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item text-muted">ì›”ê°„ ìš´ì˜í˜„í™©</li>
                        <!--end::Item-->
                    </ul>
                    <!--end::Breadcrumb-->
                </div>
                <!--end::Page title-->
            </div>
            <!--end::Toolbar container-->
        </div>
        <!--end::Toolbar-->

        <!--begin::Content-->
        <div id="kt_app_content" class="app-content flex-column-fluid">
            <!--begin::Content container-->
            <div id="kt_app_content_container" class="app-container container-xxl">
                <!-- ì›” ì„ íƒ ì˜ì—­ -->
                <div class="card card-flush mb-6">
                    <div class="card-header border-0 pt-5">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="card-label fw-bold fs-3 mb-1">ì›”ê°„ ìš´ì˜í˜„í™© ì¡°íšŒ</span>
                        </h3>
                        <div class="card-toolbar">
                            <div class="d-flex align-items-center position-relative">
                                <input class="form-control form-control-solid w-200px" placeholder="ì›” ì„ íƒ" id="monthly_datepicker" readonly/>
                                <button type="button" class="btn btn-primary ms-3" id="searchBtn">ì¡°íšŒ</button>
                                <button type="button" class="btn btn-success ms-3" id="excelDownloadBtn">ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 1.ì›”ê°„ ìš”ì•½ í†µê³„ -->
                <div class="row g-5 g-xl-8 mb-6">
                    <div class="col-xl-3">
                        <div class="card card-flush h-md-100">
                            <div class="card-header pt-5">
                                <div class="card-title d-flex flex-column">
                                    <span class="fs-2hx fw-bold text-gray-900 me-2 lh-1 ls-n2">154</span>
                                    <span class="text-gray-600 pt-1 fw-semibold fs-6">ì´ì½œ</span>
                                </div>
                            </div>
                            <div class="card-body d-flex flex-column justify-content-end pe-0">
                                <div class="d-flex fs-6 fw-semibold align-items-center">
                                    <div class="text-success flex-grow-1 fw-bold">12% ì¦ê°€</div>
                                    <div class="fw-bold text-gray-600">ì „ì›” ëŒ€ë¹„</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3">
                        <div class="card card-flush h-md-100">
                            <div class="card-header pt-5">
                                <div class="card-title d-flex flex-column">
                                    <span class="fs-2hx fw-bold text-gray-900 me-2 lh-1 ls-n2">82.5%</span>
                                    <span class="text-gray-600 pt-1 fw-semibold fs-6">ì‘ëŒ€ìœ¨</span>
                                </div>
                            </div>
                            <div class="card-body d-flex flex-column justify-content-end pe-0">
                                <div class="d-flex fs-6 fw-semibold align-items-center">
                                    <div class="text-danger flex-grow-1 fw-bold">-2.5% ê°ì†Œ</div>
                                    <div class="fw-bold text-gray-600">ì „ì›” ëŒ€ë¹„</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3">
                        <div class="card card-flush h-md-100">
                            <div class="card-header pt-5">
                                <div class="card-title d-flex flex-column">
                                    <span class="fs-2hx fw-bold text-gray-900 me-2 lh-1 ls-n2">87</span>
                                    <span class="text-gray-600 pt-1 fw-semibold fs-6">ìƒë‹´ì™„ë£Œ ê±´ìˆ˜</span>
                                </div>
                            </div>
                            <div class="card-body d-flex flex-column justify-content-end pe-0">
                                <div class="d-flex fs-6 fw-semibold align-items-center">
                                    <div class="text-success flex-grow-1 fw-bold">5% ì¦ê°€</div>
                                    <div class="fw-bold text-gray-600">ì „ì›” ëŒ€ë¹„</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3">
                        <div class="card card-flush h-md-100">
                            <div class="card-header pt-5">
                                <div class="card-title d-flex flex-column">
                                    <span class="fs-2hx fw-bold text-gray-900 me-2 lh-1 ls-n2">-</span>
                                    <span class="text-gray-600 pt-1 fw-semibold fs-6">ë¯¸êµ¬í˜„</span>
                                </div>
                            </div>
                            <div class="card-body d-flex flex-column justify-content-end pe-0">
                                <div class="d-flex fs-6 fw-semibold align-items-center">
                                    <div class="text-success flex-grow-1 fw-bold">-</div>
                                    <div class="fw-bold text-gray-600">-</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2.ì›”ê°„ í†µê³„ ì¶”ì´ -->
                <div class="card card-flush mb-6">
                    <div class="card-header border-0 pt-5">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="card-label fw-bold fs-3 mb-1">2.ì›”ê°„ í†µê³„ ì¶”ì´</span>
                        </h3>
                    </div>
                    <div class="card-body">
                        <div id="kt_monthly_trend_chart" style="height: 350px;"></div>
                    </div>
                </div>

                <!-- 3.ì£¼ì°¨ë³„ í†µê³„ -->
                <div class="card card-flush mb-6" id="weekly-stats-card">
                    <div class="card-header border-0 pt-5">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="card-label fw-bold fs-3 mb-1">3.ì£¼ì°¨ë³„ í†µê³„</span>
                        </h3>
                    </div>
                    <div class="card-body pt-0">
                        <table class="table table-row-bordered table-striped gy-5 gs-7">
                            <thead>
                                <tr class="fw-semibold fs-6 text-gray-800 text-center border-bottom border-gray-200">
                                    <th>ì¼ì</th>
                                    <th>ì´ì½œ</th>
                                    <th>ì¤‘ë³µì œê±°í˜¸</th>
                                    <th>ì‘ëŒ€í˜¸</th>
                                    <th>í¬ê¸°í˜¸</th>
                                    <th>ë¶€ì¬í˜¸</th>
                                    <th>ì´ìƒë‹´ì™„ë£Œí˜¸</th>
                                    <th>ìˆ˜ì‹ í˜¸</th>
                                    <th>ë°œì‹ í˜¸</th>
                                    <th>ì‘ëŒ€ìœ¨</th>
                                    <th>ì™„ë£Œìœ¨</th>
                                    <th>ìˆ˜ì‹ ë¹„ìœ¨</th>
                                    <th>ë°œì‹ ë¹„ìœ¨</th>
                                </tr>
                            </thead>
                            <tbody class="text-center">
                                <!-- ë°ì´í„°ëŠ” JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 4.ìƒë‹´ìœ í˜• ë¶„ì„ -->
                <div class="row g-5 g-xl-8 mb-6">
                    <!-- íŒŒì´ ì°¨íŠ¸ -->
                    <div class="col-xl-6">
                        <div class="card card-flush h-xl-100">
                            <div class="card-header border-0 pt-5">
                                <h3 class="card-title align-items-start flex-column">
                                    <span class="card-label fw-bold fs-3 mb-1">4.ìƒë‹´ìœ í˜• ë¶„ì„</span>
                                </h3>
                            </div>
                            <div class="card-body">
                                <div id="kt_monthly_counseling_types" class="min-h-auto" style="height: 350px"></div>
                            </div>
                        </div>
                    </div>
                    <!-- ë°ì´í„° í…Œì´ë¸” -->
                    <div class="col-xl-6">
                        <div class="card card-flush h-xl-100">
                            <div class="card-header border-0 pt-5">
                                <h3 class="card-title align-items-start flex-column">
                                    <span class="card-label fw-bold fs-3 mb-1">ìƒë‹´ìœ í˜• ìƒì„¸ ë‚´ì—­</span>
                                </h3>
                            </div>
                            <div class="card-body pt-0">
                                <table class="table table-row-bordered table-striped gy-5 gs-7">
                                    <thead>
                                        <tr class="fw-semibold fs-6 text-gray-800 text-center border-bottom border-gray-200">
                                            <th>ìƒë‹´ìœ í˜•</th>
                                            <th>ìƒë‹´ìˆ˜</th>
                                            <th>ë¹„ìœ¨</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-center">
                                        <!-- ë°ì´í„°ëŠ” JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 5.ì „ì›” ëŒ€ë¹„ ì‹¤ì  ë¹„êµ -->
                <div class="card card-flush mb-6">
                    <div class="card-header border-0 pt-5">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="card-label fw-bold fs-3 mb-1">5.ì „ì›” ëŒ€ë¹„ ì‹¤ì  ë¹„êµ</span>
                        </h3>
                    </div>
                    <div class="card-body">
                        <div id="kt_monthly_comparison_chart" style="height: 350px;"></div>
                    </div>
                </div>
            </div>
            <!--end::Content container-->
        </div>
        <!--end::Content-->
    </div>

    <!--begin::Javascript-->
    <script>
        // ì›” ì„ íƒ ì´ˆê¸°í™” (í˜„ì¬ ì›”ë¡œ ê¸°ë³¸ ì„¤ì •)
        var currentDate = new Date();
        var currentYearMonth = currentDate.getFullYear() + "-" + 
                               String(currentDate.getMonth() + 1).padStart(2, '0');
        
        $("#monthly_datepicker").flatpickr({
            altInput: true,
            altFormat: "F Y",
            dateFormat: "Y-m",
            defaultDate: currentYearMonth,
            plugins: []
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë°ì´í„° ë¡œë“œ
        $(document).ready(function() {
            var initialDate = $("#monthly_datepicker").val();
            if (initialDate) {
                fetchMonthlyOperationData(initialDate);
            }
        });

        // ê²€ìƒ‰ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('searchBtn').addEventListener('click', function() {
            var yearMonth = document.getElementById('monthly_datepicker').value;
            console.log('ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ë¨: ' + yearMonth);
            
            if (yearMonth) {
                fetchMonthlyOperationData(yearMonth);
            } else {
                alert('ì›”ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
            }
        });
        
        // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('excelDownloadBtn').addEventListener('click', function() {
            var yearMonth = document.getElementById('monthly_datepicker').value;
            if (!yearMonth) {
                alert('ì›”ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            downloadMonthlyOperationExcel();
        });
        
        // ì›”ê°„ ìš´ì˜í˜„í™© ë°ì´í„° ì¡°íšŒ í•¨ìˆ˜
        function fetchMonthlyOperationData(yearMonth) {
            const csrfToken = document.querySelector('meta[name="_csrf"]').getAttribute('content');
            const csrfHeader = document.querySelector('meta[name="_csrf_header"]').getAttribute('content');
            
            $.ajax({
                url: '/stat/monthly/search',
                type: 'POST',
                data: {
                    yearMonth: yearMonth
                },
                beforeSend: function(xhr) {
                    xhr.setRequestHeader(csrfHeader, csrfToken);
                },
                success: function(response) {
                    console.log('ì›”ê°„ ë°ì´í„° ìˆ˜ì‹  ì„±ê³µ:', response);
                    
                    // ë””ë²„ê¹…: ì£¼ì°¨ë³„ ë°ì´í„° í™•ì¸
                    if (response && response.weeklyStatsList) {
                        console.log('ì£¼ì°¨ë³„ í†µê³„ ë°ì´í„°:', response.weeklyStatsList);
                    } else {
                        console.error('ì£¼ì°¨ë³„ í†µê³„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    }
                    
                    if (response) {
                        // 1. ì›”ê°„ ìš”ì•½ í†µê³„ ì—…ë°ì´íŠ¸
                        updateMonthlySummary(response.summaryStats, response.yearlyComparisonData);
                        // 2. ì›”ê°„ í†µê³„ ì¶”ì´ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
                        updateMonthlyTrendChart(response.dailyStatsList);
                        // 3. ì£¼ì°¨ë³„ í†µê³„ ì—…ë°ì´íŠ¸
                        updateWeeklyTable(response.weeklyStatsList);
                        // 4. ìƒë‹´ìœ í˜• ë¶„ì„ ì—…ë°ì´íŠ¸
                        updateCounselingTypeAnalysis(response.counselingTypeStats);
                        // 5. ì „ì›” ëŒ€ë¹„ ì‹¤ì  ë¹„êµ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
                        updateMonthlyComparisonChart(response.yearlyComparisonData);
                    } else {
                        console.error('ìˆ˜ì‹ ëœ ë°ì´í„°ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
                        // ì˜¤ë¥˜ ì•Œë¦¼
                        alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('ì›”ê°„ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨:', error);
                    console.error('ìƒíƒœ ì½”ë“œ:', xhr.status);
                    console.error('ì‘ë‹µ í…ìŠ¤íŠ¸:', xhr.responseText);
                    alert('ë°ì´í„° ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            });
        }
        
        // 1. ì›”ê°„ ìš”ì•½ í†µê³„ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateMonthlySummary(summaryStats, comparisonData) {
            if (!summaryStats) return;
            
            // ì´ í†µí™” ê±´ìˆ˜
            $('.col-xl-3:eq(0) .fs-2hx').text(formatNumber(summaryStats.totalCalls || 0));
            
            // ì‘ëŒ€ìœ¨ (ì™„ë£Œìœ¨) - ê°’ì´ ì œëŒ€ë¡œ ì „ë‹¬ë˜ì§€ ì•Šì„ ê²½ìš° ì§ì ‘ ê³„ì‚°
            var answerRate = summaryStats.answerRate;
            if (answerRate === null || answerRate === undefined || answerRate === 0) {
                var totalCalls = summaryStats.totalCalls || 0;
                var answeredCalls = summaryStats.answeredCalls || 0;
                var abandonedCalls = summaryStats.abandonedCalls || 0;
                
                // ë°±ì—”ë“œ ê³„ì‚° ë¡œì§ê³¼ ì¼ì¹˜: (ì‘ëŒ€í˜¸ / (ì´ì½œ - í¬ê¸°í˜¸)) * 100
                var totalCallsForRate = totalCalls - abandonedCalls;
                answerRate = (totalCallsForRate > 0) ? ((answeredCalls / totalCallsForRate) * 100) : 0;
                console.log('ì‘ëŒ€ìœ¨ ì§ì ‘ ê³„ì‚°:', answerRate.toFixed(1) + '%', 
                           'ì‘ë‹µ ì½œ:', answeredCalls, 
                           'ì´ ì½œ:', totalCalls, 
                           'í¬ê¸°í˜¸:', abandonedCalls,
                           'ê³„ì‚°ìš© ì´ì½œ:', totalCallsForRate);
            }
            $('.col-xl-3:eq(1) .fs-2hx').text((answerRate || 0).toFixed(1) + '%');
            
            // ìƒë‹´ì™„ë£Œ ê±´ìˆ˜ (ì´ ì‘ë‹µ ê±´ìˆ˜)
            $('.col-xl-3:eq(2) .fs-2hx').text(formatNumber(summaryStats.completedCounselingCalls || 0));
            
            // í‰ê·  í†µí™” ì‹œê°„ (ì´ˆ -> ë¶„:ì´ˆ ë³€í™˜) - ë¯¸êµ¬í˜„
            $('.col-xl-3:eq(3) .fs-2hx').text('-');
            
            // ì¦ê°ë¥  ê³„ì‚° ë° í‘œì‹œ
            if (comparisonData) {
                // ì´ í†µí™” ì¦ê°ë¥ 
                var callRateChange = comparisonData.totalCallsComparisonRate;
                if (callRateChange === null || callRateChange === undefined) {
                    callRateChange = 0;
                }
                var callRateText = (callRateChange >= 0 ? 
                    callRateChange.toFixed(1) + '% ì¦ê°€' : 
                    Math.abs(callRateChange).toFixed(1) + '% ê°ì†Œ');
                var callRateClass = callRateChange >= 0 ? 'text-success' : 'text-danger';
                $('.col-xl-3:eq(0) .flex-grow-1').text(callRateText).removeClass('text-success text-danger').addClass(callRateClass);
                
                // ì‘ëŒ€ìœ¨ ì¦ê°ë¥ 
                var answerRateChange = comparisonData.answerRateComparisonRate;
                if (answerRateChange === null || answerRateChange === undefined) {
                    answerRateChange = 0;
                }
                var answerRateText = (answerRateChange >= 0 ? 
                    answerRateChange.toFixed(1) + '% ì¦ê°€' : 
                    Math.abs(answerRateChange).toFixed(1) + '% ê°ì†Œ');
                var answerRateClass = answerRateChange >= 0 ? 'text-success' : 'text-danger';
                $('.col-xl-3:eq(1) .flex-grow-1').text(answerRateText).removeClass('text-success text-danger').addClass(answerRateClass);
                
                // ìƒë‹´ì™„ë£Œ ê±´ìˆ˜ ì¦ê°ë¥ 
                var completeCallRateChange = comparisonData.completedCounselingCallsComparisonRate;
                if (completeCallRateChange === null || completeCallRateChange === undefined) {
                    completeCallRateChange = 0;
                }
                var completeCallRateText = (completeCallRateChange >= 0 ? 
                    completeCallRateChange.toFixed(1) + '% ì¦ê°€' : 
                    Math.abs(completeCallRateChange).toFixed(1) + '% ê°ì†Œ');
                var completeCallRateClass = completeCallRateChange >= 0 ? 'text-success' : 'text-danger';
                $('.col-xl-3:eq(2) .flex-grow-1').text(completeCallRateText).removeClass('text-success text-danger').addClass(completeCallRateClass);
            }
        }
        
        // ì´ˆë¥¼ MM:SS í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function formatDuration(seconds) {
            if (!seconds) return '0:00';
            var minutes = Math.floor(seconds / 60);
            var remainingSeconds = Math.floor(seconds % 60);
            return minutes + ':' + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;
        }
        
        // ìˆ«ì í¬ë§· í•¨ìˆ˜ (ì²œë‹¨ìœ„ ì½¤ë§ˆ)
        function formatNumber(num) {
            if (num === null || num === undefined) return '-';
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // 2. ì›”ê°„ í†µê³„ ì¶”ì´ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        var monthlyTrendChartInstance = null;
        function updateMonthlyTrendChart(dailyStatsList) {
            var monthlyTrendElement = document.getElementById('kt_monthly_trend_chart');
            if (!monthlyTrendElement || !dailyStatsList || dailyStatsList.length === 0) return;
            
            // ë°ì´í„° ì¶”ì¶œ
            var categories = [];
            var callsData = [];
            var answerRateData = [];
            
            dailyStatsList.forEach(function(stat) {
                // ë‚ ì§œì—ì„œ ì¼ìë§Œ ì¶”ì¶œ (MM-DD í˜•ì‹)
                var dateStr = stat.statDate;
                var shortDate = dateStr.substring(5); // "YYYY-MM-DD" -> "MM-DD"
                
                // ì£¼ë§ ì œì™¸ (í† ìš”ì¼: 6, ì¼ìš”ì¼: 0)
                var date = new Date(dateStr);
                var dayOfWeek = date.getDay();
                if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                    categories.push(shortDate);
                    callsData.push(stat.totalCalls || 0);
                    
                    // ì‘ëŒ€ìœ¨ ì‚¬ìš© (completionRate ëŒ€ì‹ )
                    var answerRate = stat.answerRate;
                    // ì‘ëŒ€ìœ¨ ê°’ì´ nullì´ê±°ë‚˜ undefinedì¸ ê²½ìš° ì§ì ‘ ê³„ì‚°
                    if (answerRate === undefined || answerRate === null) {
                        var totalCalls = stat.totalCalls || 0;
                        var answeredCalls = stat.answeredCalls || 0;
                        var abandonedCalls = stat.abandonedCalls || 0;
                        var totalCallsForRate = totalCalls - abandonedCalls;
                        answerRate = (totalCallsForRate > 0) ? ((answeredCalls / totalCallsForRate) * 100) : 0;
                    }
                    answerRateData.push(answerRate || 0);
                }
            });
            
            var monthlyTrendOptions = {
                series: [{
                    name: 'í†µí™”ê±´ìˆ˜',
                    type: 'column',
                    data: callsData
                }, {
                    name: 'ì‘ëŒ€ìœ¨',
                    type: 'line',
                    data: answerRateData
                }],
                chart: {
                    height: 350,
                    type: 'line',
                    stacked: false
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    width: [0, 3]
                },
                title: {
                    text: 'ì›”ê°„ ì¼ë³„ í†µí™”ê±´ìˆ˜ ë° ì‘ëŒ€ìœ¨ (í‰ì¼ ê¸°ì¤€)',
                    align: 'left'
                },
                xaxis: {
                    categories: categories
                },
                yaxis: [{
                    title: {
                        text: 'í†µí™”ê±´ìˆ˜',
                    },
                    decimalsInFloat: 1
                }, {
                    opposite: true,
                    title: {
                        text: 'ì‘ëŒ€ìœ¨(%)'
                    },
                    decimalsInFloat: 1
                }],
                tooltip: {
                    y: {
                        formatter: function (val, opts) {
                            if (!isFinite(val) || isNaN(val)) return '0';
                            
                            if (opts.seriesIndex === 0) {
                                return Number(val).toFixed(0) + " ê±´";
                            } else if (opts.seriesIndex === 1) {
                                return Number(val).toFixed(1) + "%";
                            }
                            return val;
                        }
                    }
                },
                fill: {
                    opacity: [0.85, 1],
                    colors: ['#009ef7', '#ff6384']
                },
                legend: {
                    position: 'top',
                    horizontalAlign: 'right',
                    offsetY: -25
                }
            };
            
            if (monthlyTrendChartInstance) {
                monthlyTrendChartInstance.updateOptions(monthlyTrendOptions);
            } else {
                monthlyTrendChartInstance = new ApexCharts(monthlyTrendElement, monthlyTrendOptions);
                monthlyTrendChartInstance.render();
            }
        }
        
        // 3. ì£¼ì°¨ë³„ í†µê³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateWeeklyTable(weeklyStatsList) {
            console.log('updateWeeklyTable í•¨ìˆ˜ í˜¸ì¶œë¨. ë°ì´í„°:', weeklyStatsList);
            
            if (!weeklyStatsList || weeklyStatsList.length === 0) {
                console.error('ì£¼ì°¨ë³„ í†µê³„ ë°ì´í„°ê°€ ì—†ê±°ë‚˜ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
                $('#weekly-stats-card tbody').html('<tr><td colspan="13" class="text-center">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>');
                return;
            }
            
            var tbody = $('#weekly-stats-card tbody');
            tbody.empty();
            
            var totalCalls = 0;
            var totalUniqueInbound = 0;
            var totalAnswered = 0;
            var totalAbandoned = 0;
            var totalBusy = 0;
            var totalCompleted = 0;
            var totalInbound = 0;
            var totalOutbound = 0;
            
            // ì£¼ì°¨ë³„ ë°ì´í„° í–‰ ì¶”ê°€
            weeklyStatsList.forEach(function(stat, index) {
                console.log('ì£¼ì°¨ ë°ì´í„° ì²˜ë¦¬ ì¤‘:', index + 1, stat);
                
                // ê°’ ê°€ì ¸ì˜¤ê¸°
                var statTotalCalls = stat.totalCalls || 0;
                var uniqueInbound = stat.uniqueInboundCalls || 0;
                var answered = stat.answeredCalls || 0;
                var abandoned = stat.abandonedCalls || 0;
                var busy = stat.busyCalls || 0;
                var completed = stat.completedCounselingCalls || 0;
                var inbound = stat.inboundCalls || 0;
                var outbound = stat.outboundCalls || 0;
                
                // ë¹„ìœ¨ ê°’ ê°€ì ¸ì˜¤ê¸° (ë°±ì—”ë“œì—ì„œ ê³„ì‚°ëœ ê°’ ë˜ëŠ” ì§ì ‘ ê³„ì‚°)
                var answerRate = stat.answerRate !== undefined ? stat.answerRate : 
                                (statTotalCalls > 0 ? (answered / statTotalCalls * 100) : 0);
                var completionRate = stat.completionRate !== undefined ? stat.completionRate : 
                                    (answered > 0 ? (completed / answered * 100) : 0);
                var inboundRate = stat.inboundRate !== undefined ? stat.inboundRate : 
                                 (statTotalCalls > 0 ? (inbound / statTotalCalls * 100) : 0);
                var outboundRate = stat.outboundRate !== undefined ? stat.outboundRate : 
                                  (statTotalCalls > 0 ? (outbound / statTotalCalls * 100) : 0);
                
                // í•©ê³„ ê³„ì‚°
                totalCalls += statTotalCalls;
                totalUniqueInbound += uniqueInbound;
                totalAnswered += answered;
                totalAbandoned += abandoned;
                totalBusy += busy;
                totalCompleted += completed;
                totalInbound += inbound;
                totalOutbound += outbound;
                
                // ì£¼ì°¨ ë¼ë²¨ - ë°±ì—”ë“œ ê°’ ë¬´ì‹œí•˜ê³  ì¸ë±ìŠ¤+1ë¡œ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œ
                var weekLabel = (index + 1) + 'ì£¼ì°¨';
                
                var row = `<tr>
                    <td>${weekLabel}</td>
                    <td>${formatNumber(statTotalCalls)}</td>
                    <td>${formatNumber(uniqueInbound)}</td>
                    <td>${formatNumber(answered)}</td>
                    <td>${formatNumber(abandoned)}</td>
                    <td>${formatNumber(busy)}</td>
                    <td>${formatNumber(completed)}</td>
                    <td>${formatNumber(inbound)}</td>
                    <td>${formatNumber(outbound)}</td>
                    <td>${(answerRate || 0).toFixed(1)}%</td>
                    <td>${(completionRate || 0).toFixed(1)}%</td>
                    <td>${(inboundRate || 0).toFixed(1)}%</td>
                    <td>${(outboundRate || 0).toFixed(1)}%</td>
                </tr>`;
                
                tbody.append(row);
            });
            
            // í•©ê³„ í–‰ ê³„ì‚°
            var totalAnswerRate = (totalAnswered > 0 && totalCalls > 0) ? ((totalAnswered / totalCalls) * 100) : 0;
            var totalCompletionRate = (totalCompleted > 0 && totalAnswered > 0) ? ((totalCompleted / totalAnswered) * 100) : 0;
            var totalInboundRate = (totalInbound > 0 && totalCalls > 0) ? ((totalInbound / totalCalls) * 100) : 0;
            var totalOutboundRate = (totalOutbound > 0 && totalCalls > 0) ? ((totalOutbound / totalCalls) * 100) : 0;
            
            // í•©ê³„ í–‰ ì¶”ê°€
            var totalRow = `<tr class="fw-bold bg-light-primary">
                <td>í•©ê³„</td>
                <td>${formatNumber(totalCalls)}</td>
                <td>${formatNumber(totalUniqueInbound)}</td>
                <td>${formatNumber(totalAnswered)}</td>
                <td>${formatNumber(totalAbandoned)}</td>
                <td>${formatNumber(totalBusy)}</td>
                <td>${formatNumber(totalCompleted)}</td>
                <td>${formatNumber(totalInbound)}</td>
                <td>${formatNumber(totalOutbound)}</td>
                <td>${(totalAnswerRate || 0).toFixed(1)}%</td>
                <td>${(totalCompletionRate || 0).toFixed(1)}%</td>
                <td>${(totalInboundRate || 0).toFixed(1)}%</td>
                <td>${(totalOutboundRate || 0).toFixed(1)}%</td>
            </tr>`;
            
            tbody.append(totalRow);
            console.log('ì£¼ì°¨ë³„ í†µê³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        }
        
        // 4. ìƒë‹´ìœ í˜• ë¶„ì„ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        var counselingTypesChartInstance = null;
        function updateCounselingTypeAnalysis(counselingTypeStats) {
            if (!counselingTypeStats || counselingTypeStats.length === 0) return;
            
            // ì°¨íŠ¸ ë°ì´í„° ì¤€ë¹„
            var chartSeries = [];
            var chartLabels = [];
            
            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            var tbody = $('.col-xl-6:eq(1) tbody');
            tbody.empty();
            
            counselingTypeStats.forEach(function(stat) {
                // í…Œì´ë¸” í–‰ ì¶”ê°€
                var row = `<tr>
                    <td>${stat.counselingTypeName || 'ê¸°íƒ€'}</td>
                    <td>${stat.count || 0}</td>
                    <td>${(stat.percentage || 0).toFixed(1)}%</td>
                </tr>`;
                
                tbody.append(row);
                
                // ì°¨íŠ¸ ë°ì´í„° ì¶”ê°€
                chartLabels.push(stat.counselingTypeName || 'ê¸°íƒ€');
                chartSeries.push(stat.count || 0);
            });
            
            // íŒŒì´ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            var counselingTypesElement = document.getElementById('kt_monthly_counseling_types');
            if (!counselingTypesElement) return;
            
            var counselingTypesOptions = {
                series: chartSeries,
                chart: {
                    type: 'pie',
                    height: 350
                },
                labels: chartLabels,
                colors: ['#fe5151', '#5ead60', '#7250e7', '#efc22e', '#487eb3'],
                legend: {
                    position: 'bottom'
                },
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            width: 300
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            };
            
            if (counselingTypesChartInstance) {
                counselingTypesChartInstance.updateOptions(counselingTypesOptions);
            } else {
                counselingTypesChartInstance = new ApexCharts(counselingTypesElement, counselingTypesOptions);
                counselingTypesChartInstance.render();
            }
        }
        
        // 5. ì „ì›” ëŒ€ë¹„ ì‹¤ì  ë¹„êµ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        var monthlyComparisonChartInstance = null;
        function updateMonthlyComparisonChart(yearlyComparison) {
            if (!yearlyComparison) return;
            
            var monthlyComparisonElement = document.getElementById('kt_monthly_comparison_chart');
            if (!monthlyComparisonElement) return;
            
            // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            var currentTotalCalls = yearlyComparison.totalCallsCurrentYear || 0;
            var previousTotalCalls = yearlyComparison.totalCallsPreviousYear || 0;
            var currentCompletedCalls = yearlyComparison.cmplCslCurrYr || 0;
            var previousCompletedCalls = yearlyComparison.cmplCslPrevYr || 0;
            
            // ì‘ë‹µë¥  ê³„ì‚°
            var currentCompletionRate = yearlyComparison.currentCompletionRate || 0;
            var previousCompletionRate = yearlyComparison.previousCompletionRate || 0;
            
            var monthlyComparisonOptions = {
                series: [{
                    name: 'ì´ë²ˆ ë‹¬',
                    data: [currentTotalCalls, currentCompletedCalls, currentCompletionRate]
                }, {
                    name: 'ì „ì›”',
                    data: [previousTotalCalls, previousCompletedCalls, previousCompletionRate]
                }],
                chart: {
                    type: 'bar',
                    height: 350
                },
                plotOptions: {
                    bar: {
                        horizontal: false,
                        columnWidth: '55%',
                        endingShape: 'rounded'
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ['transparent']
                },
                xaxis: {
                    categories: ['ì´ í†µí™”ê±´ìˆ˜', 'ì™„ë£Œê±´ìˆ˜', 'ì‘ë‹µë¥ (%)'],
                },
                yaxis: {
                    title: {
                        text: 'ê±´ìˆ˜'
                    },
                    decimalsInFloat: 1
                },
                fill: {
                    opacity: 1,
                    colors: ['#009ef7', '#ff6384']
                },
                tooltip: {
                    y: {
                        formatter: function (val, opts) {
                            if (!isFinite(val) || isNaN(val)) return '0';
                            
                            if (opts.dataPointIndex === 2) {
                                return Number(val).toFixed(1) + "%";
                            }
                            return Number(val).toFixed(0) + " ê±´";
                        }
                    }
                },
                legend: {
                    position: 'top',
                    horizontalAlign: 'right'
                }
            };
            
            if (monthlyComparisonChartInstance) {
                monthlyComparisonChartInstance.updateOptions(monthlyComparisonOptions);
            } else {
                monthlyComparisonChartInstance = new ApexCharts(monthlyComparisonElement, monthlyComparisonOptions);
                monthlyComparisonChartInstance.render();
            }
        }
        
        // ì›”ê°„ ìš´ì˜í˜„í™© ì—‘ì…€ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
        async function downloadMonthlyOperationExcel() {
            try {
                console.log('ğŸ“¥ ì›”ê°„ ìš´ì˜í˜„í™© ì´ë¯¸ì§€ í¬í•¨ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì‹œì‘...');
                showToast('ì°¨íŠ¸ì™€ í…Œì´ë¸”ì„ ì´ë¯¸ì§€ë¡œ ë³€í™˜ ì¤‘ì…ë‹ˆë‹¤...', 'info');
                
                const images = {};
                
                // 1. ì›”ê°„ ìš”ì•½ í†µê³„ ì¹´ë“œ ì„¹ì…˜ ì´ë¯¸ì§€ ìƒì„±
                const summaryCards = document.querySelector('.row.g-5.g-xl-8.mb-6');
                if (summaryCards) {
                    console.log('ğŸ“Š ì›”ê°„ ìš”ì•½ í†µê³„ ì¹´ë“œ ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
                    const cardsCanvas = await html2canvas(summaryCards, {
                        backgroundColor: '#ffffff',
                        scale: 2,  // ì ì ˆí•œ í•´ìƒë„ë¡œ ì¡°ì •
                        useCORS: true,
                        allowTaint: true,
                        width: summaryCards.offsetWidth,
                        height: summaryCards.offsetHeight,
                        scrollX: 0,
                        scrollY: 0,
                        foreignObjectRendering: true
                    });
                    images.summaryCardsImage = cardsCanvas.toDataURL('image/png', 1.0);
                }
                
                // 2. ì›”ê°„ í†µê³„ ì¶”ì´ ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± (ApexCharts - ì›ë³¸ í¬ê¸° ë¹„ìœ¨ ìœ ì§€)
                if (monthlyTrendChartInstance) {
                    console.log('ğŸ“ˆ ì›”ê°„ í†µê³„ ì¶”ì´ ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
                    try {
                        images.monthlyTrendChartImage = await monthlyTrendChartInstance.dataURI({
                            type: 'png',
                            scale: 1  // ì›ë³¸ í¬ê¸° ë¹„ìœ¨ ìœ ì§€
                        });
                    } catch (error) {
                        console.warn('ì›”ê°„ í†µê³„ ì¶”ì´ ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨:', error);
                    }
                }
                
                // 3. ì£¼ì°¨ë³„ í†µê³„ í…Œì´ë¸” ì´ë¯¸ì§€ ìƒì„±
                const weeklyStatsTable = document.querySelector('#weekly-stats-card');
                if (weeklyStatsTable) {
                    console.log('ğŸ“Š ì£¼ì°¨ë³„ í†µê³„ í…Œì´ë¸” ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
                    const weeklyCanvas = await html2canvas(weeklyStatsTable, {
                        backgroundColor: '#ffffff',
                        scale: 2,  // ì ì ˆí•œ í•´ìƒë„ë¡œ ì¡°ì •
                        useCORS: true,
                        allowTaint: true,
                        width: weeklyStatsTable.offsetWidth,
                        height: weeklyStatsTable.offsetHeight,
                        scrollX: 0,
                        scrollY: 0,
                        foreignObjectRendering: true
                    });
                    images.weeklyStatsTableImage = weeklyCanvas.toDataURL('image/png', 1.0);
                }
                
                // 4. ìƒë‹´ìœ í˜• ë¶„ì„ ì„¹ì…˜ ì´ë¯¸ì§€ ìƒì„±
                const counselingAnalysisSection = document.querySelector('.row.g-5.g-xl-8.mb-6:last-of-type');
                if (counselingAnalysisSection) {
                    console.log('ğŸ“Š ìƒë‹´ìœ í˜• ë¶„ì„ ì„¹ì…˜ ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
                    const analysisCanvas = await html2canvas(counselingAnalysisSection, {
                        backgroundColor: '#ffffff',
                        scale: 2,  // ì ì ˆí•œ í•´ìƒë„ë¡œ ì¡°ì •
                        useCORS: true,
                        allowTaint: true,
                        width: counselingAnalysisSection.offsetWidth,
                        height: counselingAnalysisSection.offsetHeight,
                        scrollX: 0,
                        scrollY: 0,
                        foreignObjectRendering: true
                    });
                    images.counselingAnalysisSectionImage = analysisCanvas.toDataURL('image/png', 1.0);
                }
                
                // 5. ìƒë‹´ìœ í˜• ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± (ApexCharts - ì›ë³¸ í¬ê¸° ë¹„ìœ¨ ìœ ì§€)
                if (counselingTypesChartInstance) {
                    console.log('ğŸ• ìƒë‹´ìœ í˜• ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
                    try {
                        images.counselingTypesChartImage = await counselingTypesChartInstance.dataURI({
                            type: 'png',
                            scale: 1  // ì›ë³¸ í¬ê¸° ë¹„ìœ¨ ìœ ì§€
                        });
                    } catch (error) {
                        console.warn('ìƒë‹´ìœ í˜• ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨:', error);
                    }
                }
                
                // 6. ì „ì›” ëŒ€ë¹„ ì‹¤ì  ë¹„êµ ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± (ApexCharts - ì›ë³¸ í¬ê¸° ë¹„ìœ¨ ìœ ì§€)
                if (monthlyComparisonChartInstance) {
                    console.log('ğŸ“Š ì „ì›” ëŒ€ë¹„ ì‹¤ì  ë¹„êµ ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
                    try {
                        images.monthlyComparisonChartImage = await monthlyComparisonChartInstance.dataURI({
                            type: 'png',
                            scale: 1  // ì›ë³¸ í¬ê¸° ë¹„ìœ¨ ìœ ì§€
                        });
                    } catch (error) {
                        console.warn('ì „ì›” ëŒ€ë¹„ ì‹¤ì  ë¹„êµ ì°¨íŠ¸ ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨:', error);
                    }
                }
                
                console.log('âœ… ëª¨ë“  ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ');
                
                // íŒŒë¼ë¯¸í„° ì¤€ë¹„
                const yearMonth = document.getElementById('monthly_datepicker').value;
                const params = {
                    yearMonth: yearMonth,
                    ...images
                };
                
                // ì„œë²„ë¡œ POST ìš”ì²­ (ì´ë¯¸ì§€ í¬í•¨)
                await downloadMonthlyExcelWithImages(params);
                
            } catch (error) {
                console.error('âŒ ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨:', error);
                showToast('ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ì´ë¯¸ì§€ë¥¼ í¬í•¨í•œ ì›”ê°„ ìš´ì˜í˜„í™© ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ìš”ì²­
        async function downloadMonthlyExcelWithImages(params) {
            try {
                showToast('ì´ë¯¸ì§€ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...', 'info');
                
                const csrfToken = document.querySelector('meta[name="_csrf"]').getAttribute('content');
                
                const response = await fetch('/stat/monthly/excel-with-images', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-TOKEN': csrfToken
                    },
                    body: JSON.stringify(params)
                });
                
                if (response.ok) {
                    // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'ì›”ê°„ìš´ì˜í˜„í™©_' + params.yearMonth + '.xlsx';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                    
                    showToast('ì´ë¯¸ì§€ê°€ í¬í•¨ëœ ì—‘ì…€ ë‹¤ìš´ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                } else {
                    throw new Error('ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜');
                }
                
            } catch (error) {
                console.error('âŒ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨:', error);
                showToast('ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function showToast(message, type = 'info') {
            const existingToast = document.querySelector('.toast-message');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = `toast-message toast-${type}`;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                max-width: 400px;
                animation: slideInRight 0.3s ease;
            `;
            
            switch (type) {
                case 'success':
                    toast.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                    break;
                case 'error':
                    toast.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                    break;
                default:
                    toast.style.background = 'linear-gradient(135deg, #3b82f6, #2563eb)';
            }
            
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 5000);
        }
        
        // ì´ˆê¸° ì°¨íŠ¸ëŠ” ë°ì´í„° ë¡œë“œ í›„ ì—…ë°ì´íŠ¸ë˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ìƒì„±í•˜ì§€ ì•ŠìŒ
    </script>
    <!--end::Javascript-->
</div>
</html> 