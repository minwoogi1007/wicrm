<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{main}">
<!--begin::Main-->
<meta name="_csrf" th:content="${_csrf.token}"/>
<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
<div layout:fragment="content">
    <script src="/assets/plugins/global/plugins.bundle.js"></script>
    <div class="d-flex flex-column flex-column-fluid">
        <!--begin::Toolbar-->
        <div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
            <!--begin::Toolbar container-->
            <div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
                <!--begin::Page title-->
                <div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
                    <!--begin::Title-->
                    <h1 class="page-heading d-flex text-gray-900 fw-bold fs-3 flex-column justify-content-center my-0">일일 운영현황</h1>
                    <!--end::Title-->
                    <!--begin::Breadcrumb-->
                    <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
                        <!--begin::Item-->
                        <li class="breadcrumb-item text-muted">
                            <a href="/main" class="text-muted text-hover-primary">Home</a>
                        </li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item">
                            <span class="bullet bg-gray-500 w-5px h-2px"></span>
                        </li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item text-muted">통계</li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item">
                            <span class="bullet bg-gray-500 w-5px h-2px"></span>
                        </li>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <li class="breadcrumb-item text-muted">일일 운영현황</li>
                        <!--end::Item-->
                    </ul>
                    <!--end::Breadcrumb-->
                </div>
                <!--end::Page title-->
            </div>
            <!--end::Toolbar container-->
        </div>
        <!--end::Toolbar-->

        <!--begin::Content-->
        <div id="kt_app_content" class="app-content flex-column-fluid">
            <!--begin::Content container-->
            <div id="kt_app_content_container" class="app-container container-xxl">
                <!-- 1.통계 현황 -->
                <div class="card card-flush mb-6">
                    <div class="card-header border-0 pt-5">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="card-label fw-bold fs-3 mb-1">1.통계 현황</span>
                        </h3>
                        <div class="card-toolbar">
                            <div class="d-flex align-items-center position-relative">
                                <input class="form-control form-control-solid w-250px" placeholder="날짜 선택" id="daily_datepicker" readonly/>
                                <button type="button" class="btn btn-primary ms-3" id="searchBtn">조회</button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body pt-0">
                        <table class="table table-row-bordered table-striped gy-5 gs-7">
                            <thead>
                                <tr class="fw-semibold fs-6 text-gray-800 text-center border-bottom border-gray-200">
                                    <th>일자</th>
                                    <th>총콜</th>
                                    <th>응대호</th>
                                    <th>포기호</th>
                                    <th>시도호</th>
                                    <th>조회호</th>
                                    <th>취결호</th>
                                    <th>부재호</th>
                                    <th>총상담완료호</th>
                                </tr>
                            </thead>
                            <tbody class="text-center">
                                <tr>
                                    <td>2024-02-02</td>
                                    <td>23</td>
                                    <td>15</td>
                                    <td>6</td>
                                    <td>17</td>
                                    <td>16</td>
                                    <td>1</td>
                                    <td>1</td>
                                    <td>94.1%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 2.통화 시간 현황 -->
                <div class="card card-flush mb-6">
                    <div class="card-header border-0 pt-5">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="card-label fw-bold fs-3 mb-1">2.통화 시간 현황</span>
                        </h3>
                    </div>
                    <div class="card-body pt-0">
                        <table class="table table-row-bordered table-striped gy-5 gs-7">
                            <thead>
                                <tr class="fw-semibold fs-6 text-gray-800 text-center border-bottom border-gray-200">
                                    <th>일자</th>
                                    <th>통화인원</th>
                                    <th>총통화시간(초)</th>
                                    <th>조회호</th>
                                    <th>CB건수</th>
                                    <th>개시건</th>
                                    <th>평균</th>
                                    <th>총통화시간</th>
                                    <th>IN 통화시간</th>
                                </tr>
                            </thead>
                            <tbody class="text-center">
                                <tr>
                                    <td>2024-02-02</td>
                                    <td>2</td>
                                    <td>15</td>
                                    <td>16</td>
                                    <td>2</td>
                                    <td>11</td>
                                    <td>0</td>
                                    <td>29</td>
                                    <td>1:08:17</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 3.상담유형 상담현황 -->
                <div class="row g-5 g-xl-8">
                    <div class="col-xl-5">
                        <div class="card card-flush h-xl-100">
                            <div class="card-header border-0 pt-5">
                                <h3 class="card-title align-items-start flex-column">
                                    <span class="card-label fw-bold fs-3 mb-1">3.상담유형 상담현황</span>
                                </h3>
                            </div>
                            <div class="card-body pt-0">
                                <table class="table table-row-bordered table-striped gy-5 gs-7">
                                    <thead>
                                        <tr class="fw-semibold fs-6 text-gray-800 text-center border-bottom border-gray-200">
                                            <th>상담유형</th>
                                            <th>상담경로</th>
                                            <th>상담수</th>
                                            <th>비율</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-center">
                                        <tr>
                                            <td>직원</td>
                                            <td>기타</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr>
                                            <td rowspan="2">직원</td>
                                            <td>적극권유/추천</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr>
                                            <td>일반문의</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr>
                                            <td rowspan="5">상품</td>
                                            <td>기타</td>
                                            <td>1</td>
                                            <td>3.2%</td>
                                        </tr>
                                        <tr>
                                            <td>일반문의</td>
                                            <td>3</td>
                                            <td>9.7%</td>
                                        </tr>
                                        <tr>
                                            <td>자발적문의</td>
                                            <td>1</td>
                                            <td>3.2%</td>
                                        </tr>
                                        <tr>
                                            <td>프로모션</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr>
                                            <td>홍보물</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr>
                                            <td>결제</td>
                                            <td>기타</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-7">
                        <div class="card card-flush h-xl-100">
                            <div class="card-body d-flex align-items-center justify-content-center">
                                <div id="kt_chart_counseling_types" class="min-h-auto" style="height: 400px; width: 100%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4.연도 대비 현황 비교 -->
                <div class="card card-flush mt-6">
                    <div class="card-header border-0 pt-5">
                        <h3 class="card-title align-items-start flex-column">
                            <span class="card-label fw-bold fs-3 mb-1">4.연도 대비 현황 비교</span>
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="row g-5 g-xl-8">
                            <div class="col-xl-6">
                                <div id="kt_chart_yearly_comparison_1" class="min-h-auto" style="height: 350px"></div>
                            </div>
                            <div class="col-xl-6">
                                <div id="kt_chart_yearly_comparison_2" class="min-h-auto" style="height: 350px"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--end::Content container-->
        </div>
        <!--end::Content-->
    </div>

    <!--begin::Javascript-->
    <script>
        // 날짜 선택 초기화
        $("#daily_datepicker").flatpickr({
            dateFormat: "Y-m-d",
            defaultDate: new Date(),
            locale: "ko"
        });

        // 검색 버튼 이벤트
        document.getElementById('searchBtn').addEventListener('click', function() {
            console.log('검색 버튼 클릭됨: ' + document.getElementById('daily_datepicker').value);
            // 검색 로직은 백엔드 구현 후 추가 예정
        });

        // 파이 차트 (상담유형)
        var counselingTypesElement = document.getElementById('kt_chart_counseling_types');
        var counselingTypesOptions = {
            series: [44.0, 20.0, 18.0, 12.0, 6.0],
            chart: {
                type: 'pie',
                height: 400
            },
            labels: ['상품', '직원', '운영', '결제', '기타'],
            colors: ['#fe5151', '#5ead60', '#7250e7', '#efc22e', '#487eb3'],
            legend: {
                position: 'right',
                offsetY: 50
            },
            responsive: [{
                breakpoint: 480,
                options: {
                    chart: {
                        width: 200
                    },
                    legend: {
                        position: 'bottom'
                    }
                }
            }]
        };
        var counselingTypesChart = new ApexCharts(counselingTypesElement, counselingTypesOptions);
        counselingTypesChart.render();

        // 막대 그래프 (연도 대비 비교 1)
        var yearlyComparisonElement1 = document.getElementById('kt_chart_yearly_comparison_1');
        var yearlyComparisonOptions1 = {
            series: [{
                name: '전년',
                data: [95, 55, 57, 56, 61, 12]
            }, {
                name: '금년',
                data: [76, 41, 35, 51, 49, 9]
            }],
            chart: {
                type: 'bar',
                height: 350
            },
            plotOptions: {
                bar: {
                    horizontal: false,
                    columnWidth: '55%',
                    endingShape: 'rounded'
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                show: true,
                width: 2,
                colors: ['transparent']
            },
            xaxis: {
                categories: ['인터넷', '일반가입', '인바운드', '재연장', '기타', '아웃바운드'],
            },
            yaxis: {
                title: {
                    text: '건수'
                }
            },
            fill: {
                opacity: 1,
                colors: ['#009ef7', '#ff6384']
            },
            tooltip: {
                y: {
                    formatter: function (val) {
                        return val + " 건"
                    }
                }
            }
        };
        var yearlyComparisonChart1 = new ApexCharts(yearlyComparisonElement1, yearlyComparisonOptions1);
        yearlyComparisonChart1.render();

        // 막대 그래프 (연도 대비 비교 2)
        var yearlyComparisonElement2 = document.getElementById('kt_chart_yearly_comparison_2');
        var yearlyComparisonOptions2 = {
            series: [{
                name: '전년',
                data: [125, 75, 100]
            }, {
                name: '금년',
                data: [105, 65, 90]
            }],
            chart: {
                type: 'bar',
                height: 350
            },
            plotOptions: {
                bar: {
                    horizontal: false,
                    columnWidth: '55%',
                    endingShape: 'rounded'
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                show: true,
                width: 2,
                colors: ['transparent']
            },
            xaxis: {
                categories: ['인바운드', '아웃바운드', '취결'],
            },
            yaxis: {
                title: {
                    text: '건수'
                }
            },
            fill: {
                opacity: 1,
                colors: ['#009ef7', '#ff6384']
            },
            tooltip: {
                y: {
                    formatter: function (val) {
                        return val + " 건"
                    }
                }
            }
        };
        var yearlyComparisonChart2 = new ApexCharts(yearlyComparisonElement2, yearlyComparisonOptions2);
        yearlyComparisonChart2.render();
    </script>
    <!--end::Javascript-->
</div>
</html> 